```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# 적절한 군집 개수 찾기
(find appropriate number of clusters)

> ### SSE를 이용하자

#### 데이터 불러오기
```{r}
train_iris = iris[, -5]
head(train_iris)
```

#### 사용자 함수
```{r}
total_within_cluster_sum_of_squares <- function(data, number_of_cluster=15, seed=1111){
  wss <- (nrow(data)-1)*sum(sapply(data,var)) # 전체 데이터 SSE(i.e. 군집은 하나)
  # plot그렸을 때, 첫번째 오는 수치
  for (i in 2:number_of_cluster){
    set.seed(seed)
    wss[i] <- kmeans(train_iris, centers = i)$tot.withinss}
  plot(1:number_of_cluster, wss, type = "b",
       xlab = "Number of Clusters", ylab = "Total within-cluster sum of squares ")
  }

total_within_cluster_sum_of_squares(train_iris)
```

> 2~3개가 적당하네